<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unstratified and Stratified  Miettinen and Nurminen Test • forestly</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Unstratified and Stratified  Miettinen and Nurminen Test">
<meta property="og:description" content="forestly">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">forestly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/design_plan.html">Design Plan of R Package forestly</a>
    </li>
    <li>
      <a href="../articles/example.html">Interactive Forest Plot for DMC</a>
    </li>
    <li>
      <a href="../articles/onboarding.html">onboarding</a>
    </li>
    <li>
      <a href="../articles/rate_compare.html">Unstratified and Stratified  Miettinen and Nurminen Test</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="rate_compare_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Unstratified and Stratified Miettinen and Nurminen Test</h1>
            
      
      
      <div class="hidden name"><code>rate_compare.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>Binary outcome is a commonly used endpoint in clinical trials. This page is to illustrate how to conduct the unstratified or stratified analysis with Miettinen and Nurminen method (M&amp;N) descrived in (Miettinen and Nurminen 1985) for risk difference analysis in R. The following statistics can be calculated within the function <code>rate_compare</code>:</p>
<ul>
<li>estimated risk difference</li>
<li>test statistic</li>
<li>confidence interval for the risk difference</li>
<li>p-value for risk difference.</li>
</ul>
</div>
<div id="statistical-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#statistical-methods" class="anchor"></a>Statistical Methods</h1>
<div id="unstratified-analysis-of-mn-method" class="section level2">
<h2 class="hasAnchor">
<a href="#unstratified-analysis-of-mn-method" class="anchor"></a>Unstratified analysis of M&amp;N method</h2>
<p>Assume the data includes two independent binomial samples with binary response variables to be analyzed/summarized and the data collected in a clinical design without stratification. Also this approach is applicable to the case when the data are collected using a stratified clinical design and the statistician would like to ignore stratification by pooling the data over strata assuming two independent binomial samples. Assume <span class="math inline">\(P_i\)</span> is the proportion of success responses in the test (<span class="math inline">\(i=1\)</span>) or control (<span class="math inline">\(i=0\)</span>) group.</p>
<div id="confidence-interval" class="section level3">
<h3 class="hasAnchor">
<a href="#confidence-interval" class="anchor"></a>Confidence Interval</h3>
<p>The confidence interval is based on the M&amp;N method and given by the roots for <span class="math inline">\(PD=P_1-P_0\)</span> of the equation:</p>
<p><span class="math display">\[\chi_\alpha^2 = \frac{(\hat{p}_1-\hat{p}_0-PD)^2}{\tilde{V}}\]</span>,</p>
<p>where <span class="math inline">\(\hat{p}_1\)</span> and <span class="math inline">\(\hat{p}_0\)</span> are the observed values of <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_0\)</span>, respectively;</p>
<ul>
<li><p><span class="math inline">\(\chi_\alpha^2\)</span> = the upper cut point of size <span class="math inline">\(\alpha\)</span> from the central chi-square distribution with 1 degree of freedom (<span class="math inline">\(\chi_\alpha^2 = 3.84\)</span> for <span class="math inline">\(95\)</span>% confidence interval);</p></li>
<li><p><span class="math inline">\(PD\)</span> = the difference between two population proportions (<span class="math inline">\(PD=P_1-P_0\)</span>);</p></li>
</ul>
<p><span class="math display">\[\tilde{V}=[\frac{\tilde{p}_1(1-\tilde{p}_1)}{n_1}+
\frac{\tilde{p}_0(1-\tilde{p}_0)}{n_0}]\frac{n_1+n_0}{n_1+n_0-1}\]</span>;</p>
<ul>
<li><p><span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_0\)</span> are the sample sizes for the test and control group, respectively;</p></li>
<li><p><span class="math inline">\(\tilde{p}_1\)</span> = maximum likelihood estimate of proportion on test computed as <span class="math inline">\(\tilde{p}_0+PD\)</span>;</p></li>
<li><p><span class="math inline">\(\tilde{p}_0\)</span> = maximum likelihood estimate of proportion on control under the constraint <span class="math inline">\(\tilde{p}_1-\tilde{p}_0=PD\)</span>.</p></li>
</ul>
<p>As stated above the 2-sided <span class="math inline">\(100(1-\alpha)\)</span>% CI is given by the roots for <span class="math inline">\(PD=P_1-P_0\)</span>. The bisection algorithm is used in the function to obtain the two roots (confidence interval) for <span class="math inline">\(PD\)</span>.</p>
</div>
<div id="p-value-and-z-statistic" class="section level3">
<h3 class="hasAnchor">
<a href="#p-value-and-z-statistic" class="anchor"></a>P-value and Z-statistic</h3>
<p>The Z-statistic is computed as:</p>
<p><span class="math display">\[Z_{diff}=\frac{\hat{p}_1-\hat{p}_0+S_0}{\sqrt{\tilde{V}}}\]</span> where <span class="math inline">\(\hat{p}_1\)</span> and <span class="math inline">\(\hat{p}_0\)</span> are the observed values for <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_0\)</span> respectively, <span class="math inline">\(S_0\)</span> is pre-specified proportion difference under the null;</p>
<ul>
<li><p><span class="math inline">\(\tilde{p}_1\)</span> = maximum likelihood estimate of proportion on test computed as <span class="math inline">\(\tilde{p}_0+S_0\)</span>;</p></li>
<li><p><span class="math inline">\(\tilde{p}_0\)</span> = maximum likelihood estimate of proportion on control under the constraint <span class="math inline">\(\tilde{p}_1-\tilde{p}_0=S_0\)</span>.</p></li>
<li><p>For non-inferiority or one-sided equivalence hypothesis with <span class="math inline">\(S_0&gt;0\)</span>, the p-value, <span class="math inline">\(Pr(Z\ge Z_{diff}|H_0)\)</span>, is computed based on <span class="math inline">\(Z_{diff}\)</span> using the standard normal distribution.</p></li>
<li><p>For non-inferiority or one-sided equivalence hypothesis with <span class="math inline">\(S_0&lt;0\)</span>, the p-value, <span class="math inline">\(Pr(Z\le Z_{diff}|H_0)\)</span>, is computed based on <span class="math inline">\(Z_{diff}\)</span> using the standard normal distribution.</p></li>
<li><p>For two-sided supriority test, the p-value <span class="math inline">\(Pr(\chi_{diff}^2\le \chi_1^2|H_0)\)</span>, is computed based on <span class="math inline">\(\chi_{diff}^2\)</span> using the chi-square distribution with 1 degree of freedom, where <span class="math inline">\(\chi_{diff}^2=Z_{diff}^2\)</span>.</p></li>
</ul>
</div>
</div>
<div id="stratified-analysis-of-mn-method" class="section level2">
<h2 class="hasAnchor">
<a href="#stratified-analysis-of-mn-method" class="anchor"></a>Stratified analysis of M&amp;N method</h2>
<p>Assume the data includes two treatment groups, test and control, and collected based on a stratified design. Within each stratum there are two independent binomial samples with binary response variables to be analyzed/summarized. The parameter of interest is the difference between the population proportions of the test and the control groups. The analysis and summaries need to be performed while adjusting for the stratifying variables.</p>
<div id="confidence-interval-1" class="section level3">
<h3 class="hasAnchor">
<a href="#confidence-interval-1" class="anchor"></a>Confidence Interval</h3>
<p>The confidence interval is based on the M&amp;N method and given by the roots for <span class="math inline">\(PD=P_1-P_0\)</span> of the equation:</p>
<p><span class="math display">\[\chi_\alpha^2 = \frac{(\hat{p}_1^*-\hat{p}_0^*-PD)^2}{\sum_{i=1}^I(W_i/\sum_{k=1}^{K}W_k)^2\tilde{V}_i}\]</span>,</p>
<p>where <span class="math inline">\(\hat{p}_s^* = \sum_{i=1}^I(W_i/\sum_{k=1}^KW_k)\hat{p}_{si}\)</span> for <span class="math inline">\(s=0,1\)</span>;</p>
<p><span class="math display">\[\tilde{V}_i=[\frac{\tilde{p}_{1i}(1-\tilde{p}_{1i})}{n_{1i}}+\frac{\tilde{p}_{0i}(1-\tilde{p}_{0i})}{n_{0i}}]\frac{n_{1i}+n_{0i}}{n_{1i}+n_{0i}-1}\]</span>;</p>
<ul>
<li>
<span class="math inline">\(W_i\)</span> is the weight for the <span class="math inline">\(i^{th}\)</span> strata;<br>
</li>
<li>$I = K = $ number of strata, <span class="math inline">\(i=k=\)</span> strata;<br>
</li>
<li>
<span class="math inline">\(n_{1i}\)</span> and <span class="math inline">\(n_{0i}\)</span> are the sample sizes in <span class="math inline">\(i^{th}\)</span> strata for the test and control group, respectively;<br>
</li>
<li>
<span class="math inline">\(\hat{p}_{1i}\)</span> and <span class="math inline">\(\hat{p}_{0i}\)</span> = observed proportion in <span class="math inline">\(i^{th}\)</span> strata for the test and control, respectively;<br>
</li>
<li>
<span class="math inline">\(\tilde{p}_{0i}\)</span> and <span class="math inline">\(\tilde{p}_{1i}\)</span> are MLE for <span class="math inline">\(P_{0i}\)</span> and <span class="math inline">\(P_{1i}\)</span>, respectively, computed under the constraint <span class="math inline">\(\tilde{p}_{1i}=\tilde{p}_{0i}+PD\)</span>.</li>
</ul>
<p>Similarly as for unstratified analysis,the 2-sided <span class="math inline">\(100(1-\alpha)\)</span>% CI is given by the roots for <span class="math inline">\(PD=P_1-P_0\)</span>, and the bisection algorithm is used in the function to obtain the two roots (confidence interval) for <span class="math inline">\(PD\)</span>.</p>
</div>
<div id="p-value-and-z-statistic-1" class="section level3">
<h3 class="hasAnchor">
<a href="#p-value-and-z-statistic-1" class="anchor"></a>P-value and Z-statistic</h3>
<p>The Z-statistic is computed as:</p>
<p><span class="math display">\[Z_{diff}=\frac{\hat{p}_1^*-\hat{p}^*_0+S_0}{\sqrt{\sum_{i=1}^I(W_i/\sum_{k=1}^{K}W_k)^2\tilde{V}_i}}\]</span> where <span class="math inline">\(S_0\)</span> is pre-specified proportion difference under the null;</p>
<ul>
<li>
<span class="math inline">\(\tilde{p}_{0i}\)</span> and <span class="math inline">\(\tilde{p}_{1i}\)</span> are MLE for <span class="math inline">\(P_{0i}\)</span> and <span class="math inline">\(P_{1i}\)</span>, respectively, computed under the constraint <span class="math inline">\(\tilde{p}_{1i}=\tilde{p}_{0i}+S_0\)</span>.</li>
</ul>
<p>The p-value can be calculated as stated above.</p>
</div>
</div>
</div>
<div id="example" class="section level1">
<h1 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h1>
<div id="load-function" class="section level2">
<h2 class="hasAnchor">
<a href="#load-function" class="anchor"></a>Load Function</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">forestly</span><span class="op">)</span></code></pre></div>
</div>
<div id="data-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-simulation" class="anchor"></a>Data Simulation</h2>
<p>We simulated a dataset with 2 treatment group for binary output. If stratum is used, we considered 4 stratum.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ana</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  response  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">80</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span>,
  stratum   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">12</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">12</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ana</span><span class="op">)</span></code></pre></div>
<pre><code>##   treatment response stratum
## 1         0        0       1
## 2         0        0       2
## 3         0        0       3
## 4         0        0       4
## 5         0        0       1
## 6         0        0       2</code></pre>
</div>
<div id="unstratified-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#unstratified-analysis" class="anchor"></a>Unstratified Analysis</h2>
<p>The function computes the risk difference, Z-statistic, p-value given the type of test, and two-sided <span class="math inline">\(100(1-\alpha)\)</span>% confidence interval of difference between two rates.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rate_compare.html">rate_compare</a></span><span class="op">(</span><span class="va">response</span><span class="op">~</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">ana</span><span class="op">)</span></code></pre></div>
<pre><code>##   r_diff  z_score         pval lower.limit upper.limit
## 1    0.4 5.759051 4.229411e-09    0.269662   0.5165743</code></pre>
</div>
<div id="stratified-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#stratified-analysis" class="anchor"></a>Stratified Analysis</h2>
<p>The sample size weighting is often used in the clinical trial. Below is the function to conduct stratified MN analysis with sample size weights.</p>
<p>We also support weight in <code>"equal"</code> and <code>"cmh"</code>. More details can be found in the <code>rate_compare</code> documentation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rate_compare.html">rate_compare</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">response</span><span class="op">~</span><span class="va">treatment</span>, strata<span class="op">=</span><span class="va">stratum</span>, data <span class="op">=</span> <span class="va">ana</span>,
                     weight<span class="op">=</span><span class="st">"ss"</span><span class="op">)</span></code></pre></div>
<pre><code>##      r_diff  z_score         pval lower.limit upper.limit
## 1 0.3998397 5.712797 5.556727e-09   0.2684383   0.5172779</code></pre>
</div>
</div>
<div id="reference" class="section level1">
<h1 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h1>
<p>Miettinen, O. and Nurminen, M, . Statistics In Medicine, 4:213-226, 1985.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yilong Zhang. Site built with pkgdown 1.6.1.
  </p>
  <p>Copyright © Merck Sharp &amp; Dohme Corp., a subsidiary of Merck &amp; Co., Inc., Kenilworth, NJ, USA.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
